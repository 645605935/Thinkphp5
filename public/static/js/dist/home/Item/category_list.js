$(function(){$(".j-addCategory").click(function(){$.jBox.show({title:"添加类目",content:_.template($("#tpl_category").html()),btnOK:{onBtnClick:function(a){var b=a.find("input[name='title']"),c=$.trim(b.val()),d=a.find("select[name='pid']").val();return""==c?(HYD.FormShowError(b,"类目名称不能为空"),!1):($.jBox.close(a),void $.ajax({url:"/Item/ajaxAddCagegory",type:"post",dataType:"json",beforeSend:function(){$.jBox.showloading()},data:{title:c,pid:d},success:function(a){1==a.status?(HYD.hint("success","恭喜，操作成功"+a.msg),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败"+a.msg),$.jBox.hideloading()}}))}}})}),$(".j-editCategory").click(function(){var a=$(this),b=a.data("id"),c={title:a.data("title"),pid:a.data("pid")},d=_.template($("#tpl_edit_category").html(),c),e=$(d);$.jBox.show({title:"编辑类目",content:e,btnOK:{onBtnClick:function(a){var c=a.find("input[name='title']"),d=$.trim(c.val()),e=a.find("select[name='pid']").val();return""==d?(HYD.FormShowError(c,"类目名称不能为空"),!1):($.jBox.close(a),void $.ajax({url:"/Item/ajaxEditCagegory",type:"post",dataType:"json",beforeSend:function(){$.jBox.showloading()},data:{title:d,pid:e,id:b},success:function(a){1==a.status?(HYD.hint("success","恭喜，操作成功"+a.msg),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败"+a.msg),$.jBox.hideloading()}}))}}})}),$(".j-del").click(function(){var a=$(this),b=a.data("id");return $.jBox.show({title:"删除类目",content:"删除类目会一起删除类目下的子类目，确认删除吗？",btnOK:{onBtnClick:function(a){$.jBox.close(a),$.ajax({url:"/Item/ajaxDelCategory",type:"post",dataType:"json",data:{id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".btn_table_delAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"批量删除类目",content:"删除类目会一起删除类目下的子类目，确认删除吗？",btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Item/DelAllCategory",type:"post",dataType:"json",data:{ids:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择需要删除的类目！")})});