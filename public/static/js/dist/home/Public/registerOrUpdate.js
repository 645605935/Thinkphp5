$(function(){var a={email:/^[a-z]([a-z0-9]*[-_]?[a-z0-9]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+[\.][a-z]{2,3}([\.][a-z]{2})?$/i,mobphone:/^1[34578]{1}\d{9}$/,telphone:/^0\d{2,3}(\-)?\d{7,8}$/,integer:/^\d+$/},b=null,c=0,d=$("#j-isRegPage").val(),e=function(a,b){$.ajax({url:"/Public/isMobileExist",type:"post",dataType:"json",data:{mobile:a},success:b})},f=function(){if(!c){var a=$("#ipt_account").val();$.post("/Public/sendCode",{mobile:a},function(a){});var d=parseInt(30);b=setInterval(function(){d-=1,c=1,0==d?(clearInterval(b),$("#btn_sendCode").text("获取验证码"),c=0):($("#btn_sendCode").text(d+"秒重新获取"),c=1)},1e3)}},g=function(){var b=$("#ipt_account"),c=$("#ipt_pwd"),d=$("#ipt_code"),e=b.val(),f=c.val(),g=d.val(),h=!0;return""==e&&h&&(LoginShowError(b,"请输入手机号码！"),b.select().focus(),h=!1),!a.mobphone.test(e)&&h&&(LoginShowError(b,"手机号码格式错误！"),b.select().focus(),h=!1),""==g&&h&&(LoginShowError(d,"请输入短信验证码！"),d.select().focus(),h=!1),""==f&&h&&(LoginShowError(c,"请输入密码!"),c.select().focus(),h=!1),(f.length<6||f.length>21)&&h&&(LoginShowError(c,"密码长度在6~21位!"),c.select().focus(),h=!1),h},h=function(){var a=$("#ipt_account"),b=$("#ipt_pwd"),c=$("#ipt_code"),e=$("#source"),f=a.val(),g=b.val(),h=c.val(),i=e.val(),j="";switch(d){case"1":j="/Public/register";break;case"0":j="/Public/forget"}return $.ajax({url:j,type:"post",dataType:"json",data:{username:f,password:g,verify:h,source:i},beforeSend:function(){$.jBox.showloading()},success:function(d){if(1==d.status)$.cookie("cache_account",f,{expires:30,path:"/"}),window.location.href=d.url;else switch(d.tab){case"username":LoginShowError(a,d.msg),a.select().focus();break;case"password":LoginShowError(b,d.msg),b.select().focus();break;case"verify":LoginShowError(c,d.msg),c.select().focus();break;case"unknown":HYD.hint("danger",d.msg)}$.jBox.hideloading()}}),!1};$("#btn_registerOrUpdate").click(function(){g()&&h()}),$("#btn_sendCode").click(function(){var b=$("#ipt_account"),c=b.val();return""==c?(LoginShowError(b,"请输入手机号码！"),void b.select().focus()):a.mobphone.test(c)?(e(c,function(a){1==a.status&&"1"==d?a.isExist?LoginShowError(b,"这个号码已经被注册！"):f():1==a.status&&"0"==d&&(a.isExist?f():LoginShowError(b,"这个号码不存在！"))}),!1):(LoginShowError(b,"手机号码格式错误！"),void b.select().focus())}),$(".clearError").bind("keypress click",function(a){var b=window.event?a.keyCode:a.which;if(13==b){if(!g())return;return void h()}LoginClearError($(this))}),$("#ipt_account").focus()});