$(function(){$(".J_add_sort").click(function(){return $.jBox.show({width:500,title:"添加分销商排名",content:_.template($("#tpl_agent_add").html()),btnOK:{onBtnClick:function(a){$.jBox.close(a);var b=a.find("input[name='user_name']").val(),c=parseFloat(a.find("input[name='commission']").val());$.ajax({url:"/User/agent_add",type:"post",dataType:"json",data:{user_name:b,commission:c},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，添加成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，添加失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-edit").click(function(){var a=$(this),b=a.data("id");defaults={sort:a.data("sort"),name:a.data("name")};var c=_.template($("#tpl_agent_edit").html(),defaults),d=$(c),e=d.find("input[name='user_name']"),f=d.find("input[name='commission']");return $.jBox.show({width:500,title:"编辑分销商排名",content:d,btnOK:{onBtnClick:function(c){$.jBox.close(c);var d=e.val(),g=parseFloat(f.val());$.ajax({url:"/User/agent_edit",type:"post",dataType:"json",data:{commission_rank_id:b,user_name:d,commission:g},beforeSend:function(){$.jBox.showloading()},success:function(b){1==b.status?(HYD.hint("success","恭喜您，编辑成功！"),a.data("sort",g),a.data("name",d),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，编辑失败："+b.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-del").click(function(){var a=$(this),b=a.data("id");return $.jBox.show({title:"提示",content:"删除后将不可恢复，确认删除吗？",btnOK:{onBtnClick:function(a){$.jBox.close(a),$.ajax({url:"/User/agent_del",type:"post",dataType:"json",data:{id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-delAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"提示",content:"删除后将不可恢复，确认删除吗？",btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/User/agent_delAll",type:"post",dataType:"json",data:{ids:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("danger","对不起，请选择要删除的分销商！")})});