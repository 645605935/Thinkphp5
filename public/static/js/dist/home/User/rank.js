$(function(){$(".j-add").click(function(){$.jBox.show({width:500,title:"添加会员等级",content:_.template($("#tpl_user_rank_add").html()),btnOK:{onBtnClick:function(a){$.jBox.close(a);var b=a.find("input[name='alias']"),c=a.find("input[name='discount']"),d=a.find("input[name='amount']"),e=a.find("input[name='count']"),f=a.find("input[name='level']"),g=b.val(),h=c.val(),i=d.val(),j=e.val(),k=f.val();$.ajax({url:"/User/add_rank",type:"post",dataType:"json",data:{alias:g,discount:h,amount:i,count:j,level:k},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，添加成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，添加失败："+a.msg),$.jBox.hideloading()}})}}})}),$(".j-modify").click(function(){var a=$(this),b=a.data("id"),c={alias:a.data("alias"),discount:a.data("discount"),amount:a.data("amount"),count:a.data("count"),level:a.data("level")},d=_.template($("#tpl_user_rank_modify").html(),c),e=$(d),f=e.find("input[name='alias']"),g=e.find("input[name='discount']"),h=e.find("input[name='amount']"),i=e.find("input[name='count']"),j=e.find("input[name='level']");return $.jBox.show({width:500,title:"编辑等级",content:e,btnOK:{onBtnClick:function(a){$.jBox.close(a);var c=f.val(),d=g.val(),e=h.val(),k=i.val(),l=j.val();$.ajax({url:"/User/edit_rank",type:"post",dataType:"json",data:{rank_id:b,alias:c,discount:d,amount:e,count:k,level:l},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，编辑成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，编辑失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-del").click(function(){var a=$(this),b=a.data("id");return $.jBox.show({width:300,title:"删除会员等级",content:"确认要删除吗？",btnOK:{onBtnClick:function(a){$.jBox.close(a),$.ajax({url:"/User/delRank",type:"post",dataType:"json",data:{id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1})});