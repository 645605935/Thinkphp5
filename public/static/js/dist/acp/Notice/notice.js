$(function(){$(".J-letter").click(function(){return $.jBox.show({width:600,height:600,title:"添加通知",content:_.template($("#tpl_notice").html()),btnOK:{onBtnClick:function(a){$.jBox.close(a);var b=a.find("input[name='title']").val(),c=a.find("textarea[name='content']").val();$.ajax({url:"/Notice/addNotice",type:"post",dataType:"json",data:{title:b,content:c},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，添加成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，添加失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".J-edit").click(function(){var a=$(this),b=a.data("id");defaults={title:a.data("title"),content:a.data("content")};var c=_.template($("#tpl_edit_notice").html(),defaults),d=$(c),e=d.find("input[name='title']"),f=d.find("textarea[name='content']");return $.jBox.show({width:600,height:600,title:"编辑站内信",content:d,btnOK:{onBtnClick:function(a){$.jBox.close(a);var c=e.val(),d=f.val();$.ajax({url:"/Notice/editNotice",type:"post",dataType:"json",data:{content:d,title:c,notice_id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，编辑成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，编辑失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".J-del").click(function(){var a=$(this),b=a.data("id");return $.jBox.show({width:300,title:"删除通知",content:"确认要删除此通知吗？",btnOK:{onBtnClick:function(a){$.jBox.close(a),$.ajax({url:"/Notice/delNotice",type:"post",dataType:"json",data:{id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".J-send").click(function(){var a=$(this),b=a.data("id");return $.jBox.show({width:300,title:"发送通知",content:"确认要发送此通知吗？",btnOK:{onBtnClick:function(a){$.jBox.close(a),$.ajax({url:"/Notice/sendNotice",type:"post",dataType:"json",data:{id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，发送成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，发送失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-delAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"批量删除通知",content:"确认要删除选中的通知吗？",btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Notice/delAllNotice",type:"post",dataType:"json",data:{ids:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择需要删除的通知！")}),$(".j-sendAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"批量发送通知",content:"确认要发送选中的通知吗？",btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Notice/sendAllNotice",type:"post",dataType:"json",data:{ids:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，发送成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，发送失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择需要发送的通知！")}),$(".J-detail").click(function(){var a=$(this);a.data("id");defaults={title:a.data("title"),content:a.data("content")};var b=_.template($("#tpl_detail_notice").html(),defaults),c=$(b);return $.jBox.show({width:600,height:600,title:"站内信详情",content:c,btnOK:{onBtnClick:function(a){$.jBox.close(a)}}}),!1})});