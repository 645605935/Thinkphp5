$(function(){$(".J-letter").click(function(){return $.jBox.show({width:600,height:600,title:"添加短信",content:_.template($("#tpl_notice").html()),btnOK:{onBtnClick:function(a){$.jBox.close(a);var b=a.find('select[name="type"]').val(),c=a.find("input[name='amount']").val(),d=a.find("textarea[name='content']").val();$.ajax({url:"/Sms/addSms",type:"post",dataType:"json",data:{type:b,amount:c,content:d},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，添加成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，添加失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".J-edit").click(function(){var a=$(this),b=a.data("id"),c={type:a.data("type"),amount:a.data("amount"),content:a.data("content")},d=_.template($("#tpl_edit_notice").html(),c),e=$(d),f=e.find('select[name="type"]'),g=e.find("input[name='amount']"),h=e.find("textarea[name='content']");return $.jBox.show({width:600,height:600,title:"编辑短信",content:e,btnOK:{onBtnClick:function(a){$.jBox.close(a);var c=f.val(),d=g.val(),e=h.val();$.ajax({url:"/Sms/editSms",type:"post",dataType:"json",data:{acp_sms_id:b,type:c,amount:d,content:e},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，编辑成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，编辑失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".J-del").click(function(){var a=$(this),b=a.data("id");return $.jBox.show({width:300,title:"删除短信",content:"确认要删除此短信吗？",btnOK:{onBtnClick:function(a){$.jBox.close(a),$.ajax({url:"/Sms/delSms",type:"post",dataType:"json",data:{id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".J-send").click(function(){var a=$(this),b=a.data("id");return $.jBox.show({width:300,title:"发送短信",content:"确认要发送此短信吗？",btnOK:{onBtnClick:function(a){$.jBox.close(a),$.ajax({url:"/Sms/sendSms",type:"post",dataType:"json",data:{id:b},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，发送成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，发送失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-delAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"批量删除短信",content:"确认要删除选中的短信吗？",btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Sms/delAllSms",type:"post",dataType:"json",data:{ids:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择需要删除的短信！")}),$(".j-sendAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"批量发送短信",content:"确认要发送选中的短信吗？",btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Sms/sendAllSms",type:"post",dataType:"json",data:{ids:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，发送成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，发送失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择需要发送的短信！")}),$(".J-detail").click(function(){{var a=$(this);a.data("id")}defaults={type:a.data("type"),amount:a.data("amount"),content:a.data("content")};{var b=_.template($("#tpl_edit_notice").html(),defaults),c=$(b);c.find('select[name="type"]'),c.find("input[name='amount']"),c.find("textarea[name='content']")}return $.jBox.show({width:600,height:600,title:"短信详情",content:c,btnOK:{onBtnClick:function(a){$.jBox.close(a)}}}),!1})});